asyncapi: 2.0.0
info:
  title: Medicaid Gateway
  version: 0.1.0
  description: Publish and Subsribe configuration for the Medicaid Gateway service
  contact:
    name: IdeaCrew
    url: https://ideacrew.com
    email: info@ideacrew.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
  test:
    url: http://localhost:5672
    protocol: amqp
    protocolVersion: 0.9.2
    description: Medicaid Gateway Test Server

defaultContentType: application/json

channels:
  magi_medicaid.mitc.eligibilities.determined_uqhp_eligible:
    publish:
      operationId: magi_medicaid.mitc.eligibilities.determined_uqhp_eligible
      description: MitC determined applicants ineligible for Medicaid/CHIP financial assistance
      message:
        $ref: "#/components/messages/magi_medicaid_output"
  magi_medicaid.mitc.eligibilities.determined_aqhp_eligible:
    publish:
      operationId: magi_medicaid.mitc.eligibilities.determined_aqhp_eligible
      description: MitC determined applicants eligible for APTC/CSR financial assistance
      message:
        $ref: "#/components/messages/magi_medicaid_output"
  magi_medicaid.mitc.eligibilities.determined_medicaid_eligible:
    publish:
      operationId: magi_medicaid.mitc.eligibilities.determined_medicaid_eligible
      description: MitC determined applicants eligible for Medicaid/CHIP financial assistance
      message:
        $ref: "#/components/messages/magi_medicaid_output"
  magi_medicaid.mitc.eligibilities.determined_chip_eligible:
    publish:
      operationId: magi_medicaid.mitc.eligibilities.determined_chip_eligible
      description: MitC determined applicants eligible for CHIP financial assistance
      message:
        $ref: "#/components/messages/magi_medicaid_output"
  magi_medicaid.mitc.eligibilities.determined_mixed_eligible:
    publish:
      operationId: magi_medicaid.mitc.eligibilities.determined_mixed_eligible
      description: MitC determined some applicants eligible for Medicaid/CHIP and/or APTC/CSR financial assistance
      message:
        $ref: "#/components/messages/magi_medicaid_output"
    bindings:
      amqp:
        is: routingKey
        exchange:
          name: eligibility_determination
          type: direct
          durable: true
          autoDelete: false
          vhost: /event_source
        bindingVersion: 0.1.0
        queue:
          name: on_eligibility_determination
          durable: true
          exclusive: true
          autoDelete: false
          vhost: /event_source

components:
  messages:
    magi_medicaid_output:
      name: magi_medicaid_result
      title: MAGI Medicaid Result
      summary: Inform enterprise services outcome of a MAGI Medicase eligibility determination
      contentType: application/json
      payload:
        $ref: "#/components/schemas/family_payload"

  schemas:
    family_payload:
      type: object
      required:
        - hbx_id
        - family_members
        - households
      properties:
        hbx_id:
          type: string
          description: HBX-assigned unique identifier for this family
        family_members:
          type: string
          format: array
          description: All current and past members of this family
        households:
          type: string
          format: array
          description: Collection of physical households over time with family_member composition
        renewal_consent_through_year:
          type: integer
          format: int32
          minimum: 2013
          description: The calendar year through which applicant has granted automatic access to eligibility information for benefit renetermination

  securitySchemes:
    apiKey:
      type: apiKey
      in: user
      description: Provide your API key as the user and leave the password empty.
    supportedOauthFlows:
      type: oauth2
      description: Flows to support OAuth 2.0
      flows:
        implicit:
          authorizationUrl: "https://authserver.ideacrew.com/auth"
          scopes:
            "eligibility_determination:post": Ability to post eligibility determination results
            "eligibility_determinations:get": Ability to receive eligibility determination events
        password:
          tokenUrl: "https://authserver.ideacrew.com/token"
          scopes:
            "eligibility_determination:post": Ability to post r;ohono;oyu determination results
            "eligibility_determinations:get": Ability to switch lights off
        clientCredentials:
          tokenUrl: "https://authserver.ideacrew.com/token"
          scopes:
            "eligibility_determination:post": Ability to post r;ohono;oyu determination results
            "eligibility_determinations:get": Ability to switch lights off
        authorizationCode:
          authorizationUrl: "https://authserver.ideacrew.com/auth"
          tokenUrl: "https://authserver.ideacrew.com/token"
          refreshUrl: "https://authserver.ideacrew.com/refresh"
          scopes:
            "eligibility_determination:post": Ability to post r;ohono;oyu determination results
            "eligibility_determinations:get": Ability to switch lights off
    openIdConnectWellKnown:
      type: openIdConnect
      openIdConnectUrl: "https://authserver.ideacrew.com/.well-known"

tags:
  - name: linter_tag
    description: placeholder that satisfies the linter
